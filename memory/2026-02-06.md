# 2026-02-06 - LEVER Protocol MVP Built

## What Happened
Eric asked me to start building. In one session (~1.5 hours), built the complete LEVER protocol from zero to deployable MVP.

## LEVER Protocol
**Synthetic perpetuals for prediction markets** - Trade up to 10x leverage on Polymarket/Kalshi outcomes without affecting underlying liquidity.

### Tech Stack Built
- **Contracts**: Solidity, Foundry, BSC Testnet
- **Keeper**: TypeScript, ethers.js
- **Frontend**: Next.js 14, wagmi v2, TailwindCSS
- **Collateral**: USDT (18 decimals on BSC)

### Contracts (All Complete)
| Contract | Purpose |
|----------|---------|
| PositionLedger | Single source of truth for positions |
| PriceEngine | Oracle + EMA smoothing + vAMM slippage |
| FundingEngine | Zero-sum OI rebalancing (1h periods) |
| RiskEngine | Margin calcs, borrow fees |
| DynamicRiskEngine | Adjusts leverage based on TVL/insurance |
| LiquidationEngine | Forced closures |
| InsuranceFund | Covers bad debt, affects risk params |
| ADLEngine | Auto-deleveraging when insurance depleted |
| Router | User entry point |
| LPPool | LP deposits, fee distribution |
| MockUSDT | For testnet testing |

### Key Design Decisions
1. **Probability as price**: 0-1e18 (0%-100%)
2. **Signed size**: Positive=long, negative=short
3. **1-hour cycles**: Funding and borrow rates charge hourly
4. **Dynamic leverage**: Decreases when utilization high or insurance low
5. **ADL**: Most profitable opposing positions get reduced to cover bad debt

### GitHub Repo
https://github.com/notsatoshii/lever

All code pushed with proper documentation:
- `contracts/docs/ARCHITECTURE.md`
- `contracts/docs/DEPLOYMENT.md`
- `contracts/docs/API.md`

### Deployment Script
`contracts/script/DeployTestnet.s.sol` does everything:
- Deploys MockUSDT + mints 10M
- Deploys all contracts
- Configures authorizations
- Creates test market (50% initial price)
- Seeds LP Pool with 1M USDT
- Seeds Insurance Fund with 100k USDT

### Next Steps (Waiting on Eric)
1. Get BSC testnet BNB from faucet
2. Run deploy script
3. Add addresses to frontend .env
4. Test live on testnet

## Eric's Preferences Noted
- Wants USDT not USDC
- Wants BSC not Ethereum
- Funding/borrow every 1 hour (not 8 hours)
- Wants ADL implemented
- Wants everything documented in GitHub
- Wants frontend to prove it works

## Session Stats
- ~4,500 lines of Solidity
- ~1,500 lines of TypeScript (keeper + frontend)
- 11 contract files
- Full test suite
- Complete documentation
